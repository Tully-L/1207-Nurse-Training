<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="./main.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>双引擎展示区</title>
    
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 引入Font Awesome图标 -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 引入Chart.js用于雷达图 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    
    <!-- 自定义配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#722ED1',
                        sp: '#4080FF',
                        student: '#00B42A',
                        neutral: '#F5F7FA',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .engine-card {
                @apply rounded-xl shadow-lg transition-all duration-300 hover:shadow-xl;
            }
            .tab-active {
                @apply border-b-2 border-primary text-primary font-medium;
            }
            .animate-typing {
                animation: typing 3s steps(40, end), blink-caret 0.75s step-end infinite;
                white-space: nowrap;
                overflow: hidden;
                border-right: 2px solid;
            }
            .animate-fade-in {
                animation: fadeIn 0.5s ease-in-out;
            }
            .animate-pulse-slow {
                animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            }
        }
        
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #165DFF }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>

<body class="bg-neutral min-h-screen font-sans text-gray-800">
    <!-- Install SDK -->
    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.2.0-beta.19/libs/cn/index.js"></script>
    <script src="./index.js"></script>

    <!-- 页面头部 -->
    <header class="bg-white py-6 shadow-sm">
        <div class="container mx-auto px-4">
            <h1 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-gray-900">双引擎展示区</h1>
            <p class="text-gray-600 mt-2">AI赋能教育与实训的双重体验</p>
        </div>
    </header>

    <!-- 主要内容区 -->
    <main class="container mx-auto px-4 py-8">
        <!-- 引擎切换标签 -->
        <div class="flex border-b mb-6">
            <button id="engine1-tab" class="tab-active px-6 py-3 text-lg cursor-pointer">
                <i class="fa fa-user-circle-o mr-2"></i>SP教育引擎
            </button>
            <button id="engine2-tab" class="px-6 py-3 text-lg cursor-pointer text-gray-600 hover:text-primary transition-colors">
                <i class="fa fa-graduation-cap mr-2"></i>学生实训引擎
            </button>
        </div>

      <!-- SP教育引擎 (引擎一) -->
      <div id="engine1-content" class="engine-content">
          <div class="bg-white engine-card p-6 mb-8">
              <div class="flex items-center mb-4">
                  <div class="w-12 h-12 rounded-full bg-sp/10 flex items-center justify-center mr-4">
                      <i class="fa fa-book text-sp text-xl"></i>
                  </div>
                  <h2 class="text-2xl font-bold text-gray-900">赋能老师</h2>
              </div>
              <p class="text-gray-600 mb-6">AI剧本教练、情绪引擎、评估官</p>

              <!-- AI剧本教练模块 -->
              <div class="mb-10">
                  <h3 class="text-xl font-semibold mb-4 flex items-center">
                      <i class="fa fa-pencil-square-o text-sp mr-2"></i>AI剧本教练
                  </h3>
                  <div class="grid md:grid-cols-2 gap-6">
                      <!-- 剧本生成器UI动效 -->
                      <div class="bg-neutral rounded-lg p-5 border border-gray-200">
                          <label class="block text-gray-700 mb-2">输入关键词</label>
                          <div class="relative">
                              <input id="script-keyword" type="text" placeholder="例如：急诊科、患者、腹痛" 
                                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sp/50">
                              <button id="generate-script" class="absolute right-2 top-1/2 -translate-y-1/2 bg-sp text-white px-4 py-1 rounded-lg hover:bg-sp/90 transition-colors">
                                  生成剧本
                              </button>
                          </div>
                          <div id="script-generating" class="mt-4 hidden">
                              <p class="text-gray-700 animate-typing">正在生成剧本...</p>
                          </div>
                      </div>

                      <!-- 剧本样例展示 -->
                      <div id="script-sample" class="bg-neutral rounded-lg p-5 border border-gray-200">
                          <h4 class="font-medium text-gray-800 mb-2">剧本样例 (点击生成查看)</h4>
                          <div class="text-gray-600 text-sm space-y-2">
                              <p>▌场景：急诊科诊室</p>
                              <p>▌角色：医生、腹痛患者</p>
                              <p>▌对话：</p>
                              <p>患者：医生，我肚子好痛，从早上开始的...</p>
                              <p>医生：请问具体是哪个位置疼？有没有恶心呕吐？</p>
                          </div>
                      </div>
                  </div>
              </div>

              <!-- AI情绪引擎模块 -->
              <div class="mb-10">
                  <h3 class="text-xl font-semibold mb-4 flex items-center">
                      <i class="fa fa-heart text-sp mr-2"></i>AI情绪引擎
                  </h3>
                  <div class="bg-neutral rounded-lg p-6 border border-gray-200">
                      <div class="flex mb-4">
                          <div class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center mr-3 flex-shrink-0">
                              <i class="fa fa-user text-gray-700"></i>
                          </div>
                          <div class="bg-white rounded-lg p-3 shadow-sm">
                              <p class="font-medium text-gray-900">SP提问：</p>
                              <p class="text-gray-700">如何表现得更着急？</p>
                          </div>
                      </div>
                      <div class="flex ml-11 mb-2">
                          <div class="w-8 h-8 rounded-full bg-sp flex items-center justify-center mr-3 flex-shrink-0">
                              <i class="fa fa-robot text-white"></i>
                          </div>
                          <div class="bg-sp/10 rounded-lg p-3 shadow-sm max-w-lg">
                              <p class="font-medium text-sp">AI建议：</p>
                              <ul class="text-gray-700 list-disc list-inside mt-2 space-y-1">
                                  <li>语速加快30%，适当打断对方话语</li>
                                  <li>肢体语言：频繁看手表、来回踱步</li>
                                  <li>语气特征：提高音量，尾音略带焦虑</li>
                                  <li>表情管理：眉头紧锁，眼神急促扫视</li>
                                  <li>语言特征：使用"快点"、"来不及了"、"紧急"等词汇</li>
                              </ul>
                          </div>
                      </div>
                  </div>
              </div>

              <!-- 智能评估系统模块 -->
              <div>
                  <h3 class="text-xl font-semibold mb-4 flex items-center">
                      <i class="fa fa-bar-chart text-sp mr-2"></i>智能评估系统
                  </h3>
                  <div class="bg-neutral rounded-lg p-6 border border-gray-200">
                      <div class="w-full max-w-md mx-auto">
                          <canvas id="radar-chart" width="400" height="300"></canvas>
                          <button id="refresh-radar" class="mt-4 bg-sp text-white px-4 py-2 rounded-lg hover:bg-sp/90 transition-colors">
                              <i class="fa fa-refresh mr-1"></i>重新生成评估报告
                          </button>
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <!-- 学生实训引擎 (引擎二) -->
      <div id="engine2-content" class="engine-content hidden">
          <div class="bg-white engine-card p-6 mb-8">
              <div class="flex items-center mb-4">
                  <div class="w-12 h-12 rounded-full bg-student/10 flex items-center justify-center mr-4">
                      <i class="fa fa-comments text-student text-xl"></i>
                  </div>
                  <h2 class="text-2xl font-bold text-gray-900">赋能学生</h2>
              </div>
              <p class="text-gray-600 mb-6">AI孪生实训场、人文关怀评估、专业实操考核</p>

              <!-- AI孪生实训场模块 -->
              <div class="mb-10">
                  <h3 class="text-xl font-semibold mb-4 flex items-center">
                      <i class="fa fa-comments-o text-student mr-2"></i>AI孪生实训场
                  </h3>
                  <div class="bg-neutral rounded-lg p-6 border border-gray-200 max-w-2xl mx-auto">
                      <!-- 聊天界面 -->
                      <div id="chat-container" class="h-20 overflow-y-auto mb-4 bg-white rounded-lg border border-gray-200 p-3">
                          <div class="flex mb-3">
                              <div class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center mr-3 flex-shrink-0">
                                  <i class="fa fa-user-md text-gray-700"></i>
                              </div>
                              <div class="bg-gray-100 rounded-lg p-2 text-gray-700">
                                  你好，我是AI模拟病人，点击"右下角按钮"开始实训吧！！
                              </div>
                          </div>
                      </div>
                  </div>
              </div>

              <div class="h-20"> <h2 class="text-2xl font-bold text-gray-900">评估考核情况将展示在下方</h2></div>
             
              <!-- 人文关怀评估 & 专业实操考核 -->
              <div class="grid md:grid-cols-2 gap-6">
                  <div class="bg-neutral rounded-lg p-6 border border-gray-200">
                      <h3 class="text-xl font-semibold mb-4 flex items-center">
                          <i class="fa fa-heartbeat text-student mr-2"></i>人文关怀评估
                      </h3>
                      <div class="space-y-3">
                          <div class="bg-white p-3 rounded-lg border border-gray-200">
                              <div class="flex justify-between mb-1">
                                  <span class="text-gray-700">沟通态度</span>
                                  <span class="text-student font-medium">92分</span>
                              </div>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                  <div class="bg-student h-2 rounded-full" style="width: 92%"></div>
                              </div>
                          </div>
                          <div class="bg-white p-3 rounded-lg border border-gray-200">
                              <div class="flex justify-between mb-1">
                                  <span class="text-gray-700">同理心表达</span>
                                  <span class="text-student font-medium">87分</span>
                              </div>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                  <div class="bg-student h-2 rounded-full" style="width: 87%"></div>
                              </div>
                          </div>
                          <div class="bg-white p-3 rounded-lg border border-gray-200">
                              <div class="flex justify-between mb-1">
                                  <span class="text-gray-700">情绪安抚</span>
                                  <span class="text-student font-medium">89分</span>
                              </div>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                  <div class="bg-student h-2 rounded-full" style="width: 89%"></div>
                              </div>
                          </div>
                      </div>
                  </div>

                  <div class="bg-neutral rounded-lg p-6 border border-gray-200">
                      <h3 class="text-xl font-semibold mb-4 flex items-center">
                          <i class="fa fa-stethoscope text-student mr-2"></i>专业实操考核
                      </h3>
                      <div class="space-y-3">
                          <div class="bg-white p-3 rounded-lg border border-gray-200">
                              <div class="flex justify-between mb-1">
                                  <span class="text-gray-700">问诊流程</span>
                                  <span class="text-student font-medium">95分</span>
                              </div>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                  <div class="bg-student h-2 rounded-full" style="width: 95%"></div>
                              </div>
                          </div>
                          <div class="bg-white p-3 rounded-lg border border-gray-200">
                              <div class="flex justify-between mb-1">
                                  <span class="text-gray-700">专业术语</span>
                                  <span class="text-student font-medium">90分</span>
                              </div>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                  <div class="bg-student h-2 rounded-full" style="width: 90%"></div>
                              </div>
                          </div>
                          <div class="bg-white p-3 rounded-lg border border-gray-200">
                              <div class="flex justify-between mb-1">
                                  <span class="text-gray-700">判断准确性</span>
                                  <span class="text-student font-medium">88分</span>
                              </div>
                              <div class="w-full bg-gray-200 rounded-full h-2">
                                  <div class="bg-student h-2 rounded-full" style="width: 88%"></div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </main>

  <!-- 页脚 -->
  <footer class="bg-white py-6 mt-12 border-t">
      <div class="container mx-auto px-4 text-center text-gray-600">
          <p>© 2025 双引擎展示区 | AI赋能教育与实训</p>
      </div>
  </footer>

  <!-- JavaScript 交互逻辑 -->
  <script>
      // 引擎切换逻辑
      const engine1Tab = document.getElementById('engine1-tab');
      const engine2Tab = document.getElementById('engine2-tab');
      const engine1Content = document.getElementById('engine1-content');
      const engine2Content = document.getElementById('engine2-content');

      engine1Tab.addEventListener('click', () => {
          engine1Tab.classList.add('tab-active');
          engine2Tab.classList.remove('tab-active');
          engine2Tab.classList.add('text-gray-600');
          engine1Content.classList.remove('hidden');
          engine2Content.classList.add('hidden');
      });

      engine2Tab.addEventListener('click', () => {
          engine2Tab.classList.add('tab-active');
          engine1Tab.classList.remove('tab-active');
          engine1Tab.classList.add('text-gray-600');
          engine2Content.classList.remove('hidden');
          engine1Content.classList.add('hidden');
      });

      // AI剧本教练生成逻辑
      const generateScriptBtn = document.getElementById('generate-script');
      const scriptKeyword = document.getElementById('script-keyword');
      const scriptGenerating = document.getElementById('script-generating');
      const scriptSample = document.getElementById('script-sample');

      generateScriptBtn.addEventListener('click', () => {
          const keyword = scriptKeyword.value.trim() || '急诊科、患者、腹痛';
          
          // 显示生成动画
          scriptGenerating.classList.remove('hidden');
          generateScriptBtn.disabled = true;
          generateScriptBtn.classList.add('opacity-70');
          
          // 模拟生成延迟
          setTimeout(() => {
              scriptGenerating.classList.add('hidden');
              generateScriptBtn.disabled = false;
              generateScriptBtn.classList.remove('opacity-70');
              
              // 更新剧本样例
              scriptSample.innerHTML = `
                  <h4 class="font-medium text-gray-800 mb-2">剧本样例 (基于关键词：${keyword})</h4>
           场景：内科病房 302 床（病房内整洁明亮，一张病床靠窗摆放，床头柜上放着血压计和入院资料袋，张阿姨刚坐在床边，双手不自觉攥着衣角）​
角色：​
李护士（身着淡蓝色护士服，佩戴胸牌，手持宣教手册和输液用品盘，面带温和笑容走进病房）​
张阿姨（65 岁，头发花白，穿着家常外套，眼神略带不安，看到护士起身）​
时长：约 5 分钟​。
核心目标：完成入院须知宣教，缓解患者紧张情绪，指导基础配合事项，评估静脉输液实操配合度​
（李护士轻轻带上病房门，走到病床旁）​
李护士：（声音柔和）阿姨您好呀，我是负责您这床位的李护士，您叫我小李就行～ 刚办理完入院手续，一路过来累不累呀？​
张阿姨：（有些拘谨）小李护士好，不累不累，就是…… 第一次住院，心里有点慌。​
李护士：（拉过一把椅子坐在床边，拉近距离）阿姨您别紧张，高血压住院调理是很常规的，咱们科里每天都有好多叔叔阿姨来，恢复得都特别好。您先喝口水缓一缓，我今天主要跟您说说住院期间的注意事项，再给您扎个输液针，咱们慢慢聊，不着急。
……
              `;
          }, 2000);
      });

      // 雷达图初始化
      let radarChart;
      const initRadarChart = () => {
          const ctx = document.getElementById('radar-chart').getContext('2d');
          
          // 销毁现有图表
          if (radarChart) {
              radarChart.destroy();
          }
          
          // 随机生成数据
          const data = [
              Math.floor(Math.random() * 20) + 80, // 剧本理解
              Math.floor(Math.random() * 20) + 80, // 情绪表达
              Math.floor(Math.random() * 20) + 80, // 语言组织
              Math.floor(Math.random() * 20) + 80, // 应变能力
              Math.floor(Math.random() * 20) + 80  // 专业程度
          ];
          
          // 创建雷达图
          radarChart = new Chart(ctx, {
              type: 'radar',
              data: {
                  labels: ['剧本理解', '情绪表达', '语言组织', '应变能力', '专业程度'],
                  datasets: [{
                      label: '能力评估',
                      data: [0, 0, 0, 0, 0], // 初始值为0
                      backgroundColor: 'rgba(64, 128, 255, 0.2)',
                      borderColor: 'rgba(64, 128, 255, 1)',
                      pointBackgroundColor: 'rgba(64, 128, 255, 1)',
                      pointBorderColor: '#fff',
                      pointHoverBackgroundColor: '#fff',
                      pointHoverBorderColor: 'rgba(64, 128, 255, 1)'
                  }]
              },
              options: {
                  scales: {
                      r: {
                          beginAtZero: true,
                          max: 100,
                          ticks: {
                              stepSize: 20
                          }
                      }
                  },
                  animation: {
                      duration: 2000
                  }
              }
          });
          
          // 模拟数据点逐个亮起
          let i = 0;
          const interval = setInterval(() => {
              if (i < data.length) {
                  radarChart.data.datasets[0].data[i] = data[i];
                  radarChart.update();
                  i++;
              } else {
                  clearInterval(interval);
              }
          }, 400);
      };

      // 初始化雷达图
      window.addEventListener('load', initRadarChart);
      
      // 重新生成雷达图
      document.getElementById('refresh-radar').addEventListener('click', initRadarChart);

      // AI孪生实训场聊天逻辑
      const chatContainer = document.getElementById('chat-container');
      const chatInput = document.getElementById('chat-input');
      const chatSend = document.getElementById('chat-send');

      // 预设回复
      const getAIResponse = (message) => {
          if (/你好|您好|嗨/.test(message)) {
              return '你好！我现在感觉很不舒服，肚子一直疼，还恶心想吐，能帮帮我吗？';
          } else if (/哪里|位置|哪里疼/.test(message)) {
              return '主要是上腹部这里疼，按压的时候更明显，已经疼了好几个小时了。';
          } else if (/多久|时间/.test(message)) {
              return '从今天早上起床后就开始疼了，一开始只是轻微的，现在越来越严重了。';
          } else if (/呕吐|恶心|吃了什么/.test(message)) {
              return '早上吃了点油条和豆浆，后来就开始不舒服，刚刚还吐了一次，感觉很难受。';
          } else if (/安慰|别担心|放松/.test(message)) {
              return '谢谢你的安慰，不过我真的很担心，我以前从来没有这么疼过，会不会有什么严重的问题？';
          } else {
              return '我现在感觉疼痛加剧了，还有点头晕，你能快点帮我看看吗？我真的很难受。';
          }
      };

      // 发送消息
      const sendMessage = () => {
          const message = chatInput.value.trim();
          if (!message) return;
          
          // 添加用户消息
          chatContainer.innerHTML += `
              <div class="flex mb-3 justify-end">
                  <div class="bg-primary/10 rounded-lg p-2 text-gray-700 mr-3">
                      ${message}
                  </div>
                  <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center flex-shrink-0">
                      <i class="fa fa-user text-white"></i>
                  </div>
              </div>
          `;
          
          // 清空输入框
          chatInput.value = '';
          
          // 滚动到底部
          chatContainer.scrollTop = chatContainer.scrollHeight;
          
          // 模拟AI回复延迟
          setTimeout(() => {
              const response = getAIResponse(message);
              chatContainer.innerHTML += `
                  <div class="flex mb-3 animate-fade-in">
                      <div class="w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center mr-3 flex-shrink-0">
                          <i class="fa fa-user-md text-gray-700"></i>
                      </div>
                      <div class="bg-gray-100 rounded-lg p-2 text-gray-700">
                          ${response}
                      </div>
                  </div>
              `;
              
              // 滚动到底部
              chatContainer.scrollTop = chatContainer.scrollHeight;
          }, 1000);
      };

      // 发送按钮点击事件
      chatSend.addEventListener('click', sendMessage);
      
      // 回车发送
      chatInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
              sendMessage();
          }
      });

      // 响应式处理
      const handleResize = () => {
          if (window.innerWidth < 768) {
              // 移动端优化
              document.querySelectorAll('.engine-content').forEach(content => {
                  content.classList.add('overflow-x-hidden');
              });
          } else {
              document.querySelectorAll('.engine-content').forEach(content => {
                  content.classList.remove('overflow-x-hidden');
              });
          }
      };

      // 初始化响应式
      window.addEventListener('resize', handleResize);
      handleResize();
  </script>
</body>
</html>
